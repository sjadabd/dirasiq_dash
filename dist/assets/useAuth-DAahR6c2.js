import{r as i,z as n,k as y}from"./index-DzRnBGoW.js";const e=i(null),o=i(null),l=i(!1);function g(r,s=null){if(!r||r==="undefined"||r==="null")return s;try{return JSON.parse(r)}catch{return s}}function T(){const r=y(),s=()=>{let t=localStorage.getItem("user");const a=localStorage.getItem("accessToken");if(!t||!a)return!1;let u=null;try{u=JSON.parse(t)}catch{u=g(t),typeof t=="object"&&(u=t)}return u&&typeof u=="object"?(e.value=u,o.value=a,l.value=!0,!0):!1};l.value||s();const d=(t,a)=>{e.value=t,o.value=a,l.value=!0,localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("studyYear",JSON.stringify(t.studyYear)),localStorage.setItem("accessToken",a)},v=()=>{e.value=null,o.value=null,l.value=!1,localStorage.removeItem("user"),localStorage.removeItem("accessToken"),localStorage.removeItem("results"),r.push("/login")},p=t=>{e.value={...e.value,...t},localStorage.setItem("user",JSON.stringify(e.value))},c=n(()=>e.value?!e.value.phone||!e.value.address||!e.value.bio||e.value.experienceYears===0:!1),f=()=>{var a;if(!l.value){r.push("/login");return}switch((a=e.value)==null?void 0:a.userType){case"teacher":c.value?r.push("/teacher/profile-setup"):r.push("/teacher/dashboard");break;case"super_admin":case"admin":r.push("/admin/dashboard");break;case"student":c.value?r.push("/student/profile-setup"):r.push("/student/dashboard");break;default:r.push("/dashboard")}},m=t=>{if(!e.value)return!1;switch(t){case"teacher":return e.value.userType==="teacher";case"student":return e.value.userType==="student";case"admin":return e.value.userType==="admin";case"super_admin":return e.value.userType==="super_admin";case"any_admin":return e.value.userType==="admin"||e.value.userType==="super_admin";default:return!1}},h=n(()=>{var t;return((t=e.value)==null?void 0:t.status)==="active"});return{user:n(()=>e.value),token:n(()=>o.value),isAuthenticated:n(()=>l.value),requiresProfileCompletion:c,isUserActive:h,login:d,logout:v,updateUser:p,loadUserFromStorage:s,redirectBasedOnUserStatus:f,hasPermission:m}}export{T as u};
