import{_ as I}from"./BaseAlert-CIbD5vpV.js";import{_ as S}from"./SmartTable-BBOnU4NK.js";import{_ as k}from"./AppBreadcrumbs-4YtabGru.js";import C from"./teacher_api-nZLuEPFA.js";import{n as w}from"./number-DRUmGIrN.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as v,a as A,c as g}from"./VCard-5UFuo9Gy.js";import{c as h,b as s,f as D,n as f,e as l,o as c,d as p,p as N,t as _,V as O,v as T,s as y}from"./index-Dmazqufq.js";import{V}from"./VDivider-BLGk5e6u.js";import{V as q,a as U}from"./VRow-Cfs-sVJ7.js";import"./VCardText-CjxXXCA6.js";import"./VDialog-DbDU-h44.js";import"./VDataTable-Cu3_7uXZ.js";import"./VSelect-Ci3tM8yu.js";import"./VList-2eAnxCjm.js";import"./VAvatar-Dibs5cVm.js";import"./VImg-CpbG_9zB.js";import"./VChip-mqYz0viO.js";import"./VTable-DFA04fiE.js";import"./filter-Bq6oWsmX.js";import"./VTooltip-C4tPPmBK.js";import"./axios-BuMR_4uE.js";const W={data(){const o=this.$route.query.courseId||null,e=this.$route.query.courseName||null;return{courseId:o,courseName:e,breadcrumbItems:[{title:"الرئيسية",disabled:!1,to:"/teacher/index"},{title:"الكورسات",disabled:!1,to:"/teacher/course/show-course"},{title:"طلاب الكورس",disabled:!0}],table:{totalItems:0,Data:[],actions:[],loading:!1,headers:[{title:"#",type:"strong",sortable:!1,key:"num"},{title:"اسم الطالب",type:"strong",sortable:!0,key:"name"}],tableSettings:{options:{page:1,limit:10,search:null}}},alert:{open:!1,message:null,type:"success"}}},created(){if(!this.courseId){this.showAlert("error","لم يتم تمرير معرف الكورس");return}this.getDataAxios()},methods:{numberWithComma:w,goBack(){this.$router.push({path:"/teacher/course/show-course"})},async getDataAxios(){var o,e;if(this.courseId){this.table.loading=!0;try{const{page:a,limit:u,search:t}=this.table.tableSettings.options,n=t||"",r=(await C.getStudentsByCoursePaginated(this.courseId,{page:a,limit:u,q:n})).data||{},m=r.data||[],i=r.pagination||{};this.table.totalItems=i.total||m.length||0,this.table.tableSettings.options={...this.table.tableSettings.options,page:i.page||a,limit:i.limit||u},this.table.Data=m.map((b,x)=>({id:b.id,num:(this.table.tableSettings.options.page-1)*this.table.tableSettings.options.limit+x+1,name:b.name}))}catch(a){this.showAlert("error",((e=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:e.message)||"حدث خطأ أثناء جلب طلاب الكورس")}finally{this.table.loading=!1}}},reload(){this.table.tableSettings.options={page:1,limit:10,search:null},this.getDataAxios()},updateTableOptions(o){this.table.tableSettings.options={...this.table.tableSettings.options,...o},this.getDataAxios()},showAlert(o,e){Object.assign(this.alert,{type:o,message:e,open:!0})}}},j={key:0,class:"text-subtitle-2 text-medium-emphasis"},z={class:"text-subtitle-2 text-medium-emphasis"};function E(o,e,a,u,t,n){const d=k,r=S,m=I;return c(),h("div",null,[s(d,{items:t.breadcrumbItems},null,8,["items"]),s(v,{class:"my-4",elevation:"3",rounded:"lg"},{default:l(()=>[s(A,{class:"d-flex align-center py-4 px-6"},{default:l(()=>[s(N,{icon:"ri-team-line",color:"primary",class:"me-2",size:"24"}),p("div",null,[e[2]||(e[2]=p("h3",{class:"text-h5 font-weight-bold mb-1"},"طلاب الكورس",-1)),t.courseName?(c(),h("div",j,_(t.courseName),1)):f("",!0)]),s(O),s(T,{color:"primary",variant:"text","prepend-icon":"ri-arrow-go-back-line",onClick:n.goBack},{default:l(()=>e[3]||(e[3]=[y(" عودة إلى الكورسات ")])),_:1},8,["onClick"])]),_:1}),s(V),s(g,null,{default:l(()=>[s(q,{class:"align-center"},{default:l(()=>[s(U,{cols:"12",md:"6"},{default:l(()=>[p("div",z,[e[4]||(e[4]=y(" إجمالي الطلاب: ")),p("strong",null,_(n.numberWithComma(t.table.totalItems)),1)])]),_:1})]),_:1})]),_:1}),s(V),s(g,null,{default:l(()=>[s(r,{headers:t.table.headers,items:t.table.Data,actions:t.table.actions,loading:t.table.loading,totalItems:t.table.totalItems,tableOptions:t.table.tableSettings.options,onUpdateTableOptions:n.updateTableOptions},null,8,["headers","items","actions","loading","totalItems","tableOptions","onUpdateTableOptions"])]),_:1})]),_:1}),t.alert.open?(c(),D(m,{key:0,modelValue:t.alert.open,"onUpdate:modelValue":e[0]||(e[0]=i=>t.alert.open=i),type:t.alert.type,message:t.alert.message,closable:!0,"close-text":"موافق",onClose:e[1]||(e[1]=i=>t.alert.open=!1)},null,8,["modelValue","type","message"])):f("",!0)])}const rt=B(W,[["render",E]]);export{rt as default};
