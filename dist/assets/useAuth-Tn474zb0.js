import{r as c,l,B as h}from"./index-B-ugD3CV.js";const e=c(null),n=c(null),t=c(!1);function g(u,s=null){if(!u||u==="undefined"||u==="null")return s;try{return JSON.parse(u)}catch{return s}}function S(){const u=h(),s=()=>{const a=g(localStorage.getItem("user")),r=localStorage.getItem("accessToken");return a&&r?(e.value=JSON.parse(a),n.value=r,t.value=!0,!0):!1};t.value||s();const i=(a,r)=>{e.value=a,n.value=r,t.value=!0,localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("studyYear",JSON.stringify(a.studyYear)),localStorage.setItem("accessToken",r)},d=()=>{e.value=null,n.value=null,t.value=!1,localStorage.removeItem("user"),localStorage.removeItem("accessToken"),localStorage.removeItem("results"),u.push("/login")},v=a=>{e.value={...e.value,...a},localStorage.setItem("user",JSON.stringify(e.value))},o=l(()=>e.value?!e.value.phone||!e.value.address||!e.value.bio||e.value.experienceYears===0:!1),p=()=>{var r;if(!t.value){u.push("/login");return}switch((r=e.value)==null?void 0:r.userType){case"teacher":o.value?u.push("/teacher/profile-setup"):u.push("/teacher/dashboard");break;case"super_admin":case"admin":u.push("/admin/dashboard");break;case"student":o.value?u.push("/student/profile-setup"):u.push("/student/dashboard");break;default:u.push("/dashboard")}},m=a=>{if(!e.value)return!1;switch(a){case"teacher":return e.value.userType==="teacher";case"student":return e.value.userType==="student";case"admin":return e.value.userType==="admin";case"super_admin":return e.value.userType==="super_admin";case"any_admin":return e.value.userType==="admin"||e.value.userType==="super_admin";default:return!1}},f=l(()=>{var a;return((a=e.value)==null?void 0:a.status)==="active"});return{user:l(()=>e.value),token:l(()=>n.value),isAuthenticated:l(()=>t.value),requiresProfileCompletion:o,isUserActive:f,login:i,logout:d,updateUser:v,loadUserFromStorage:s,redirectBasedOnUserStatus:p,hasPermission:m}}export{S as u};
