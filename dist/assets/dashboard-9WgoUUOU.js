import{T as C}from"./teacher_api-CgB6fFx4.js";import{r as g,K as R,B as j,c as D,b as s,e,o as f,d as a,t as i,f as x,k as u,q as n,b8 as S,F as T,b9 as B,s as F}from"./index-B_A_UGf-.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as U}from"./VContainer-o1v0C72Q.js";import{V as h,a as l}from"./VRow-DsXvHsvC.js";import{V as m}from"./VCard-CBPwRQhR.js";import{V as q}from"./VAvatar-BaPloNUq.js";import{V as E}from"./VImg-Mh6Lj_73.js";import{V as J}from"./VChip-BWlPf9tC.js";import"./axios-WFtL0f35.js";import"./VCardText-BWyx6VBY.js";const K={class:"teacher-dashboard"},M={class:"text-h4 mb-2"},O={class:"text-body-1 mb-0"},$={class:"text-caption mt-2"},G={class:"text-h5"},H={class:"text-h5"},W={class:"text-h5"},X={class:"text-h5"},Y={class:"text-h5"},Z={class:"text-h5"},tt={class:"d-flex justify-center py-6"},et={class:"text-h4"},st={class:"text-h4"},at={class:"text-h4"},ot={class:"text-h4"},lt={class:"text-h4"},it={class:"d-flex justify-center py-6"},dt={class:"d-flex align-center justify-space-between mb-2"},nt={class:"text-subtitle-1 fw-600"},rt={class:"text-body-1 mb-1"},ut={class:"text-body-2 text-medium-emphasis"},mt={__name:"dashboard",setup(ct){const P=j(),v=g(null),V=g(!0),I=g(!0),c=g({totalStudents:0,totalCourses:0,activeStudents:0,activeCourses:0,sessionsToday:0,totalDeposit:0,receivedDeposit:0,remainingDeposit:0,studentTotalDue:0,studentAmountPaid:0,studentAmountRemaining:0}),k=g([]),L=p=>{switch((p||"").toLowerCase()){case"confirmed":return"مؤكدة";case"pending":return"قيد الانتظار";case"cancelled":return"ملغاة";case"rejected":return"مرفوضة";default:return p||""}},b=p=>{const t=Number(p??0);try{return new Intl.NumberFormat("en-IQ").format(t)+" د.ع"}catch{return(t||0).toLocaleString("en-IQ")+" د.ع"}};return R(async()=>{var t,d,_,y,N,z,w,A;const p=localStorage.getItem("user");if(p)v.value=JSON.parse(p);else{P.push("/login");return}try{const r=await C.getDashboard(),o=((t=r==null?void 0:r.data)==null?void 0:t.data)??(r==null?void 0:r.data)??{};c.value={totalStudents:Number(o.totalStudents??0),totalCourses:Number(o.totalCourses??0),activeStudents:Number(o.activeStudents??0),activeCourses:Number(o.activeCourses??0),sessionsToday:Number(o.sessionsToday??0),totalDeposit:Number(o.totalDeposit??((d=o==null?void 0:o.depositInvoices)==null?void 0:d.totalAmount)??0),receivedDeposit:Number(o.receivedDeposit??((_=o==null?void 0:o.depositInvoices)==null?void 0:_.receivedAmount)??0),remainingDeposit:Number(o.remainingDeposit??((y=o==null?void 0:o.depositInvoices)==null?void 0:y.remainingAmount)??0),studentTotalDue:Number(((N=o==null?void 0:o.studentInvoices)==null?void 0:N.totalDue)??0),studentAmountPaid:Number(((z=o==null?void 0:o.studentInvoices)==null?void 0:z.amountPaid)??0),studentAmountRemaining:Number(((w=o==null?void 0:o.studentInvoices)==null?void 0:w.amountRemaining)??0)}}catch(r){console.warn("Failed to load teacher dashboard:",r)}finally{V.value=!1}try{const r=await C.getUpcomingToday(),o=((A=r==null?void 0:r.data)==null?void 0:A.data)??[];k.value=Array.isArray(o)?o:[]}catch(r){console.warn("Failed to load upcoming today:",r)}finally{I.value=!1}}),(p,t)=>(f(),D("div",K,[s(U,{fluid:"",class:"pa-6"},{default:e(()=>[s(h,{class:"mb-6"},{default:e(()=>[s(l,{cols:"12"},{default:e(()=>[s(m,{color:"primary",variant:"tonal",class:"pa-6"},{default:e(()=>[s(h,{align:"center"},{default:e(()=>[s(l,{cols:"12",md:"8"},{default:e(()=>{var d,_,y;return[a("h1",M,"مرحباً "+i((d=v.value)==null?void 0:d.name)+"! 👋",1),a("p",O,i((_=v.value)==null?void 0:_.email),1),a("p",$," عضو منذ "+i(new Date((y=v.value)==null?void 0:y.createdAt).toLocaleDateString("en-IQ")),1)]}),_:1}),s(l,{cols:"12",md:"4",class:"text-center"},{default:e(()=>[s(q,{size:"80",color:"primary"},{default:e(()=>{var d;return[(d=v.value)!=null&&d.profileImagePath?(f(),x(E,{key:0,src:`http://localhost:3000${v.value.profileImagePath}`,alt:"User Avatar",cover:""},null,8,["src"])):(f(),x(u,{key:1,size:"40"},{default:e(()=>t[0]||(t[0]=[n("mdi-account")])),_:1}))]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(h,{class:"mb-6",style:{"justify-content":"center"}},{default:e(()=>[s(l,{cols:"12"},{default:e(()=>t[1]||(t[1]=[a("h2",{class:"text-h5 mb-4"},"المدفوعات والفواتير",-1)])),_:1}),s(l,{cols:"12",md:"4"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"36",color:"primary",class:"mb-2"},{default:e(()=>t[2]||(t[2]=[n("mdi-cash")])),_:1}),t[3]||(t[3]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"},"إجمالي مبالغ العربون",-1)),a("div",G,i(b(c.value.totalDeposit)),1)]),_:1})]),_:1}),s(l,{cols:"12",md:"4"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"36",color:"success",class:"mb-2"},{default:e(()=>t[4]||(t[4]=[n("mdi-cash-check")])),_:1}),t[5]||(t[5]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"},"المستلم من العربون",-1)),a("div",H,i(b(c.value.receivedDeposit)),1)]),_:1})]),_:1}),s(l,{cols:"12",md:"4"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"36",color:"warning",class:"mb-2"},{default:e(()=>t[6]||(t[6]=[n("mdi-cash-remove")])),_:1}),t[7]||(t[7]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"},"المتبقي من العربون",-1)),a("div",W,i(b(c.value.remainingDeposit)),1)]),_:1})]),_:1}),s(l,{cols:"12",md:"4"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"36",color:"primary",class:"mb-2"},{default:e(()=>t[8]||(t[8]=[n("mdi-receipt")])),_:1}),t[9]||(t[9]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"},"إجمالي المستحق على الطلاب",-1)),a("div",X,i(b(c.value.studentTotalDue)),1)]),_:1})]),_:1}),s(l,{cols:"12",md:"4"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"36",color:"success",class:"mb-2"},{default:e(()=>t[10]||(t[10]=[n("mdi-receipt-text-check")])),_:1}),t[11]||(t[11]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"},"المدفوع من الطلاب",-1)),a("div",Y,i(b(c.value.studentAmountPaid)),1)]),_:1})]),_:1}),s(l,{cols:"12",md:"4"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"36",color:"warning",class:"mb-2"},{default:e(()=>t[12]||(t[12]=[n("mdi-receipt-text-remove")])),_:1}),t[13]||(t[13]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"},"المتبقي على الطلاب",-1)),a("div",Z,i(b(c.value.studentAmountRemaining)),1)]),_:1})]),_:1}),s(l,{cols:"12"},{default:e(()=>t[14]||(t[14]=[a("h2",{class:"text-h5 mb-4"},"إحصائياتك",-1)])),_:1}),V.value?(f(),x(l,{key:0,cols:"12"},{default:e(()=>[a("div",tt,[s(S,{indeterminate:"",color:"primary",size:"48"})])]),_:1})):(f(),D(T,{key:1},[s(l,{cols:"12",sm:"6",md:"2"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"48",color:"primary",class:"mb-2"},{default:e(()=>t[15]||(t[15]=[n("mdi-account-group")])),_:1}),a("h3",et,i(c.value.totalStudents),1),t[16]||(t[16]=a("p",{class:"text-body-2 text-medium-emphasis"},"إجمالي الطلاب",-1))]),_:1})]),_:1}),s(l,{cols:"12",sm:"6",md:"2"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"48",color:"success",class:"mb-2"},{default:e(()=>t[17]||(t[17]=[n("mdi-book-open")])),_:1}),a("h3",st,i(c.value.totalCourses),1),t[18]||(t[18]=a("p",{class:"text-body-2 text-medium-emphasis"},"إجمالي الدورات",-1))]),_:1})]),_:1}),s(l,{cols:"12",sm:"6",md:"2"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"48",color:"info",class:"mb-2"},{default:e(()=>t[19]||(t[19]=[n("mdi-account-check")])),_:1}),a("h3",at,i(c.value.activeStudents),1),t[20]||(t[20]=a("p",{class:"text-body-2 text-medium-emphasis"},"الطلاب النشطون",-1))]),_:1})]),_:1}),s(l,{cols:"12",sm:"6",md:"2"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"48",color:"warning",class:"mb-2"},{default:e(()=>t[21]||(t[21]=[n("mdi-book-check")])),_:1}),a("h3",ot,i(c.value.activeCourses),1),t[22]||(t[22]=a("p",{class:"text-body-2 text-medium-emphasis"},"الدورات النشطة",-1))]),_:1})]),_:1}),s(l,{cols:"12",sm:"6",md:"2"},{default:e(()=>[s(m,{class:"pa-4 text-center",elevation:"2"},{default:e(()=>[s(u,{size:"48",color:"secondary",class:"mb-2"},{default:e(()=>t[23]||(t[23]=[n("mdi-calendar-clock")])),_:1}),a("h3",lt,i(c.value.sessionsToday),1),t[24]||(t[24]=a("p",{class:"text-body-2 text-medium-emphasis"},"حصص اليوم",-1))]),_:1})]),_:1})],64))]),_:1}),s(h,{class:"mb-6"},{default:e(()=>[s(l,{cols:"12"},{default:e(()=>t[25]||(t[25]=[a("h2",{class:"text-h5 mb-4"},"الدروس القادمة اليوم",-1)])),_:1}),I.value?(f(),x(l,{key:0,cols:"12"},{default:e(()=>[a("div",it,[s(S,{indeterminate:"",color:"primary",size:"32"})])]),_:1})):k.value.length?(f(!0),D(T,{key:2},F(k.value,d=>(f(),x(l,{key:d.sessionId,cols:"12",sm:"6",md:"4"},{default:e(()=>[s(m,{elevation:"2",class:"pa-4"},{default:e(()=>[a("div",dt,[a("div",nt,i(d.courseName||"دورة"),1),s(J,{color:d.state==="confirmed"?"success":d.state==="pending"?"warning":"default",size:"small"},{default:e(()=>[n(i(L(d.state)),1)]),_:2},1032,["color"])]),a("div",rt,i(d.title),1),a("div",ut,[s(u,{size:"18",class:"me-1"},{default:e(()=>t[27]||(t[27]=[n("mdi-clock-outline")])),_:1}),n(" "+i(d.startTime)+" - "+i(d.endTime),1)])]),_:2},1024)]),_:2},1024))),128)):(f(),x(l,{key:1,cols:"12"},{default:e(()=>[s(B,{type:"info",variant:"tonal",border:"start","border-color":"info"},{default:e(()=>t[26]||(t[26]=[n(" لا توجد دروس قادمة اليوم. ")])),_:1})]),_:1}))]),_:1})]),_:1})]))}},Vt=Q(mt,[["__scopeId","data-v-c7111fa2"]]);export{Vt as default};
