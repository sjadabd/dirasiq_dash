import{_ as I}from"./BaseAlert-D7cfiezh.js";import{_ as S}from"./SmartTable-vTrBuHIK.js";import{_ as k}from"./AppBreadcrumbs-33hHCNVE.js";import C from"./teacher_api-Bgok66l7.js";import{n as w}from"./number-DRUmGIrN.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as v,a as A,c as g}from"./VCard-D4uEzfmu.js";import{c as h,b as s,f as D,n as f,e as i,o as c,d as p,p as N,t as _,V as O,v as T,s as y}from"./index-CXn58W-A.js";import{V}from"./VDivider-BMfDbzm1.js";import{V as q,a as U}from"./VRow-LCDPsJz5.js";import"./VCardText-BpiNX1gO.js";import"./VDialog-D16EyZSq.js";import"./VDataTable-CGtwdRji.js";import"./VPagination-CBlQxPNH.js";import"./VSelect-dpM-Mmrr.js";import"./VList-CSVmTKRH.js";import"./VAvatar-RzyGemFQ.js";import"./VImg-Cara8jvF.js";import"./VChip-3e4YXY2a.js";import"./VTable-Cgv4B3w5.js";import"./filter-C0X7ZpB7.js";import"./VTooltip-QLJUwG06.js";import"./axios-DwhOaX7i.js";const W={data(){const o=this.$route.query.courseId||null,e=this.$route.query.courseName||null;return{courseId:o,courseName:e,breadcrumbItems:[{title:"الرئيسية",disabled:!1,to:"/teacher/index"},{title:"الكورسات",disabled:!1,to:"/teacher/course/show-course"},{title:"طلاب الكورس",disabled:!0}],table:{totalItems:0,Data:[],actions:[],loading:!1,headers:[{title:"#",type:"strong",sortable:!1,key:"num"},{title:"اسم الطالب",type:"strong",sortable:!0,key:"name"}],tableSettings:{options:{page:1,limit:10,search:null}}},alert:{open:!1,message:null,type:"success"}}},created(){if(!this.courseId){this.showAlert("error","لم يتم تمرير معرف الكورس");return}this.getDataAxios()},methods:{numberWithComma:w,goBack(){this.$router.push({path:"/teacher/course/show-course"})},async getDataAxios(){var o,e;if(this.courseId){this.table.loading=!0;try{const{page:a,limit:u,search:t}=this.table.tableSettings.options,r=t||"",n=(await C.getStudentsByCoursePaginated(this.courseId,{page:a,limit:u,q:r})).data||{},m=n.data||[],l=n.pagination||{};this.table.totalItems=l.total||m.length||0,this.table.tableSettings.options={...this.table.tableSettings.options,page:l.page||a,limit:l.limit||u},this.table.Data=m.map((b,x)=>({id:b.id,num:(this.table.tableSettings.options.page-1)*this.table.tableSettings.options.limit+x+1,name:b.name}))}catch(a){this.showAlert("error",((e=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:e.message)||"حدث خطأ أثناء جلب طلاب الكورس")}finally{this.table.loading=!1}}},reload(){this.table.tableSettings.options={page:1,limit:10,search:null},this.getDataAxios()},updateTableOptions(o){this.table.tableSettings.options={...this.table.tableSettings.options,...o},this.getDataAxios()},showAlert(o,e){Object.assign(this.alert,{type:o,message:e,open:!0})}}},j={key:0,class:"text-subtitle-2 text-medium-emphasis"},z={class:"text-subtitle-2 text-medium-emphasis"};function E(o,e,a,u,t,r){const d=k,n=S,m=I;return c(),h("div",null,[s(d,{items:t.breadcrumbItems},null,8,["items"]),s(v,{class:"my-4",elevation:"3",rounded:"lg"},{default:i(()=>[s(A,{class:"d-flex align-center py-4 px-6"},{default:i(()=>[s(N,{icon:"ri-team-line",color:"primary",class:"me-2",size:"24"}),p("div",null,[e[2]||(e[2]=p("h3",{class:"text-h5 font-weight-bold mb-1"},"طلاب الكورس",-1)),t.courseName?(c(),h("div",j,_(t.courseName),1)):f("",!0)]),s(O),s(T,{color:"primary",variant:"text","prepend-icon":"ri-arrow-go-back-line",onClick:r.goBack},{default:i(()=>e[3]||(e[3]=[y(" عودة إلى الكورسات ")])),_:1},8,["onClick"])]),_:1}),s(V),s(g,null,{default:i(()=>[s(q,{class:"align-center"},{default:i(()=>[s(U,{cols:"12",md:"6"},{default:i(()=>[p("div",z,[e[4]||(e[4]=y(" إجمالي الطلاب: ")),p("strong",null,_(r.numberWithComma(t.table.totalItems)),1)])]),_:1})]),_:1})]),_:1}),s(V),s(g,null,{default:i(()=>[s(n,{headers:t.table.headers,items:t.table.Data,actions:t.table.actions,loading:t.table.loading,totalItems:t.table.totalItems,tableOptions:t.table.tableSettings.options,onUpdateTableOptions:r.updateTableOptions},null,8,["headers","items","actions","loading","totalItems","tableOptions","onUpdateTableOptions"])]),_:1})]),_:1}),t.alert.open?(c(),D(m,{key:0,modelValue:t.alert.open,"onUpdate:modelValue":e[0]||(e[0]=l=>t.alert.open=l),type:t.alert.type,message:t.alert.message,closable:!0,"close-text":"موافق",onClose:e[1]||(e[1]=l=>t.alert.open=!1)},null,8,["modelValue","type","message"])):f("",!0)])}const mt=B(W,[["render",E]]);export{mt as default};
