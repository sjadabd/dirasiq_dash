import{_ as B}from"./AppBreadcrumbs-33hHCNVE.js";import{a as k}from"./admin_api-D74WUyfn.js";import{k as A,r as m,m as F,c as I,o as x,b as s,e as o,d as g,p as T,s as i,v as b,f as h,n as j,aZ as q,t as w,a_ as D}from"./index-CXn58W-A.js";import{u as E}from"./useAuth-VHD4mt5d.js";import{a as S,V as U}from"./VCard-D4uEzfmu.js";import{V as z}from"./VCardText-BpiNX1gO.js";import{V as M}from"./VSnackbar-Dkiy1QcD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-DwhOaX7i.js";import"./VAvatar-RzyGemFQ.js";import"./VImg-Cara8jvF.js";const P={class:"pa-6 d-flex flex-column gap-4"},Q={class:"d-flex align-center gap-2"},R={class:"d-flex justify-end mt-4"},ae={__name:"booking-confirm-fee",setup(Z){const _=A(),{hasPermission:C}=E(),c=m(!1),V=m(!1),f=m(0),p=m(""),l=m({show:!1,message:"",color:"success"});async function y(){var n,a,r,t,u;c.value=!0,p.value="";try{const e=await k.getBookingConfirmFee(),v=((n=e==null?void 0:e.data)==null?void 0:n.success)||(e==null?void 0:e.success),d=((a=e==null?void 0:e.data)==null?void 0:a.data)||(e==null?void 0:e.data)||e;if(!v)throw new Error(((r=e==null?void 0:e.data)==null?void 0:r.message)||"تعذر جلب الرسوم");f.value=Number((d==null?void 0:d.feeIqd)??0)}catch(e){p.value=((u=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:u.message)||(e==null?void 0:e.message)||"تعذر جلب الرسوم"}finally{c.value=!1}}async function N(){var a,r,t,u;const n=Number(f.value);if(Number.isNaN(n)||n<0){l.value={show:!0,message:"الرسوم يجب أن تكون رقمًا أكبر أو يساوي 0",color:"error"};return}V.value=!0;try{const e=await k.setBookingConfirmFee(n),v=((a=e==null?void 0:e.data)==null?void 0:a.success)||(e==null?void 0:e.success),d=((r=e==null?void 0:e.data)==null?void 0:r.message)||(v?"تم الحفظ بنجاح":"تعذر الحفظ");l.value={show:!0,message:d,color:v?"success":"error"}}catch(e){l.value={show:!0,message:((u=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:u.message)||(e==null?void 0:e.message)||"تعذر الحفظ",color:"error"}}finally{V.value=!1}}return F(async()=>{if(!C("super_admin")){_.push("/login");return}await y()}),(n,a)=>{const r=B;return x(),I("div",P,[s(r,{items:[{title:"الرئيسية",disabled:!1,to:"/admin/dashboard"},{title:"الإعدادات",disabled:!1,to:"/admin/settings"},{title:"رسوم تأكيد طلب الطالب",disabled:!0}]}),s(U,{elevation:"2"},{default:o(()=>[s(S,{class:"d-flex align-center justify-space-between"},{default:o(()=>[g("div",Q,[s(T,{color:"primary"},{default:o(()=>a[3]||(a[3]=[i("mdi-cash")])),_:1}),a[4]||(a[4]=g("span",null,"رسوم تأكيد طلب الطالب",-1))]),s(b,{variant:"text",size:"small",loading:c.value,onClick:y},{default:o(()=>a[5]||(a[5]=[i("تحديث")])),_:1},8,["loading"])]),_:1}),s(z,null,{default:o(()=>[p.value?(x(),h(q,{key:0,type:"error",variant:"tonal",density:"comfortable",class:"mb-4"},{default:o(()=>[i(w(p.value),1)]),_:1})):j("",!0),s(D,{modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=t=>f.value=t),type:"number",label:"الرسوم (IQD)",variant:"outlined",disabled:c.value,min:"0"},null,8,["modelValue","disabled"]),a[7]||(a[7]=g("div",{class:"text-caption text-medium-emphasis mt-2"}," إذا كانت القيمة 0 فهذا يعني لا يوجد خصم عند التأكيد. ",-1)),g("div",R,[s(b,{color:"primary",loading:V.value,onClick:N},{default:o(()=>a[6]||(a[6]=[i("حفظ")])),_:1},8,["loading"])])]),_:1})]),_:1}),s(M,{modelValue:l.value.show,"onUpdate:modelValue":a[2]||(a[2]=t=>l.value.show=t),color:l.value.color,location:"top",timeout:4e3},{actions:o(()=>[s(b,{variant:"text",onClick:a[1]||(a[1]=t=>l.value.show=!1)},{default:o(()=>a[8]||(a[8]=[i("إغلاق")])),_:1})]),default:o(()=>[i(w(l.value.message)+" ",1)]),_:1},8,["modelValue","color"])])}}};export{ae as default};
